# GoConnect Server Configuration Example
# Copy this file to .env or set these as environment variables

# ============================================================================
# REQUIRED: Server Configuration
# ============================================================================

# Server listen address (default: 0.0.0.0)
SERVER_HOST=0.0.0.0

# Server listen port (default: 8080)
SERVER_PORT=8080

# Environment: development or production (default: production)
SERVER_ENVIRONMENT=production

# ============================================================================
# REQUIRED: Database Configuration (PostgreSQL)
# ============================================================================

# PostgreSQL host
DB_HOST=localhost

# PostgreSQL port (default: 5432)
DB_PORT=5432

# Database name
DB_NAME=goconnect

# Database user
DB_USER=goconnect

# Database password
DB_PASSWORD=your_secure_password_here

# SSL mode: disable, require, verify-ca, verify-full (default: require)
DB_SSLMODE=require

# Connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=300s

# ============================================================================
# REQUIRED: JWT Configuration
# ============================================================================

# JWT secret key - MUST be at least 32 characters
# Generate a secure key: openssl rand -base64 32
JWT_SECRET=your_very_secure_random_jwt_secret_key_min_32_chars

# Access token lifetime (default: 15m)
JWT_ACCESS_TTL=15m

# Refresh token lifetime (default: 168h = 7 days)
JWT_REFRESH_TTL=168h

# Optional: Separate refresh token secret (leave empty to use JWT_SECRET)
JWT_REFRESH_SECRET=

# ============================================================================
# REQUIRED: WireGuard Configuration
# ============================================================================

# WireGuard interface name (default: wg0)
WG_INTERFACE_NAME=wg0

# WireGuard server private key (generate with: wg genkey)
# This should be kept SECRET
WG_PRIVATE_KEY=your_wireguard_private_key_here

# WireGuard server public key (generate with: echo "private_key" | wg pubkey)
# This is shared with clients (must be exactly 44 characters)
WG_SERVER_PUBKEY=your_wireguard_public_key_44_chars_base64

# Server public endpoint (clients will connect to this)
# Format: hostname:port or IP:port
WG_SERVER_ENDPOINT=vpn.example.com:51820

# WireGuard listen port (default: 51820)
WG_PORT=51820

# DNS servers for clients (comma-separated)
WG_DNS=1.1.1.1,8.8.8.8

# MTU for WireGuard interface (default: 1420)
WG_MTU=1420

# Persistent keepalive in seconds (default: 25)
WG_KEEPALIVE=25

# ============================================================================
# OPTIONAL: Redis Configuration (for session management)
# ============================================================================

# Redis host (default: localhost)
REDIS_HOST=localhost

# Redis port (default: 6379)
REDIS_PORT=6379

# Redis password (leave empty if no auth required)
REDIS_PASSWORD=

# Redis database number (default: 0)
REDIS_DB=0

# ============================================================================
# OPTIONAL: Audit Configuration
# ============================================================================

# SQLite database path for audit logs
AUDIT_SQLITE_DSN=./audit.db

# Secrets for hashing sensitive data (comma-separated base64 keys)
# Generate with: openssl rand -base64 32
AUDIT_HASH_SECRETS=your_base64_secret_for_hashing

# Enable async audit logging (default: true)
AUDIT_ASYNC=true

# Async queue size (default: 1024)
AUDIT_QUEUE_SIZE=1024

# Number of async workers (default: 1)
AUDIT_WORKER_COUNT=1

# Flush interval (default: 5s)
AUDIT_FLUSH_INTERVAL=5s

# ============================================================================
# OPTIONAL: CORS Configuration
# ============================================================================

# Allowed origins (comma-separated, use * for all in development)
CORS_ALLOWED_ORIGINS=http://localhost:3000,https://app.example.com

# Allow credentials (default: true)
CORS_ALLOW_CREDENTIALS=true

# Max age for preflight cache in seconds (default: 3600)
CORS_MAX_AGE=3600

# ============================================================================
# QUICK START GUIDE
# ============================================================================
# 1. Copy this file: cp config.example.env .env
# 2. Generate JWT secret: openssl rand -base64 32
# 3. Generate WireGuard keys:
#    Private: wg genkey
#    Public: echo "YOUR_PRIVATE_KEY" | wg pubkey
# 4. Update DB_HOST, DB_PASSWORD, WG_SERVER_ENDPOINT
# 5. Run migrations: ./goconnect-server -migrate
# 6. Start server: ./goconnect-server
