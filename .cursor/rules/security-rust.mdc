---
description: Rust/Tauri security rules for GoConnect Desktop
globs: **/*.rs
alwaysApply: true
---
# Secure Rust Development for GoConnect Desktop

## 1. Avoid Unsafe Code
- Do not use `unsafe` blocks unless absolutely necessary
- If used, document the reason thoroughly

## 2. Validate All External Input
- All input from users, files, environment must be validated
- Check type, length, and format before use

## 3. Handle Errors Explicitly
- Always handle `Result` and `Option` types explicitly
- Do not use `unwrap()` or `expect()` on values that may fail

```rust
// ❌ Unsafe
let value = some_option.unwrap();

// ✅ Safe
let value = some_option.ok_or_else(|| anyhow!("value not found"))?;
```

## 4. Prevent Integer Overflows
- Use checked arithmetic (`checked_add`, `checked_sub`)
- Enable overflow checks in release builds

## 5. Avoid Panics in Production
- Do not use code that may panic
- Handle errors gracefully

## 6. Do Not Expose Sensitive Data
- Do not log secrets or credentials
- Redact sensitive fields in error messages

## 7. Use Strong Types for Security-Critical Data
- Use newtype wrappers for tokens, passwords
- Prevent accidental misuse

```rust
struct ApiToken(String);
struct Password(String);
```

## 8. Limit Third-Party Crates
- Only use well-maintained crates
- Regularly audit dependencies with `cargo audit`

## 9. Avoid Dynamic Code Execution
- Do not use `eval`-like behavior with untrusted input

## 10. Prefer Immutability
- Use `let` instead of `let mut` when possible
- Prefer immutable data structures
